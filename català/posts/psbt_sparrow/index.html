<!DOCTYPE html>
<html lang="català" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Com fer una transacció amb UTXOs de wallets diferents amb Sparrow | Descobreix Bitcoin i la Lightning Network</title>
<meta name="keywords" content="Wallets, UTXO management, PSBT, Sparrow, Layer 1, Bitcoin-cli">
<meta name="description" content="Suposem que en Bob i la Alice comparteixen pis i volen comprar un televisor que val 2 bitcoins pagant la meitat cada un.
Per fer-ho en Bob podria enviar 1 bitcoin a la Alice perquè ella fes el pagament del televisor, però com que les comissions de xarxa són bastant elevades, decideixen crear una transacció conjunta on hi hagi dos inputs, un de l&rsquo;Alice i un del Bob.

&#x1f4a1; Els exemples pràctics del post estan fets en testnet. Per tant, si es vol executar les comandes del Bob i l&rsquo;Alice amb els mateixos valors o buscar les transaccions a un explorador s&rsquo;ha de fer des de les versions de testnet corresponents.">
<meta name="author" content="Pol Espinasa">
<link rel="canonical" href="https://pesvi.xyz/catal%C3%A0/posts/psbt_sparrow/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css" integrity="sha256-1vzSCk&#43;4bvpN&#43;sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://pesvi.xyz/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://pesvi.xyz/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://pesvi.xyz/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://pesvi.xyz/apple-touch-icon.png">
<link rel="mask-icon" href="https://pesvi.xyz/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="english" href="https://pesvi.xyz/posts/psbt_sparrow/">
<link rel="alternate" hreflang="català" href="https://pesvi.xyz/catal%C3%A0/posts/psbt_sparrow/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-KXYVPZQE88"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-KXYVPZQE88');
        }
      </script><meta property="og:url" content="https://pesvi.xyz/catal%C3%A0/posts/psbt_sparrow/">
  <meta property="og:site_name" content="Descobreix Bitcoin i la Lightning Network">
  <meta property="og:title" content="Com fer una transacció amb UTXOs de wallets diferents amb Sparrow">
  <meta property="og:description" content="Suposem que en Bob i la Alice comparteixen pis i volen comprar un televisor que val 2 bitcoins pagant la meitat cada un. Per fer-ho en Bob podria enviar 1 bitcoin a la Alice perquè ella fes el pagament del televisor, però com que les comissions de xarxa són bastant elevades, decideixen crear una transacció conjunta on hi hagi dos inputs, un de l’Alice i un del Bob.
💡 Els exemples pràctics del post estan fets en testnet. Per tant, si es vol executar les comandes del Bob i l’Alice amb els mateixos valors o buscar les transaccions a un explorador s’ha de fer des de les versions de testnet corresponents.">
  <meta property="og:locale" content="català">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-07T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-04-07T00:00:00+00:00">
    <meta property="article:tag" content="Wallets">
    <meta property="article:tag" content="UTXO Management">
    <meta property="article:tag" content="PSBT">
    <meta property="article:tag" content="Sparrow">
    <meta property="article:tag" content="Layer 1">
    <meta property="article:tag" content="Bitcoin-Cli">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Com fer una transacció amb UTXOs de wallets diferents amb Sparrow">
<meta name="twitter:description" content="Suposem que en Bob i la Alice comparteixen pis i volen comprar un televisor que val 2 bitcoins pagant la meitat cada un.
Per fer-ho en Bob podria enviar 1 bitcoin a la Alice perquè ella fes el pagament del televisor, però com que les comissions de xarxa són bastant elevades, decideixen crear una transacció conjunta on hi hagi dos inputs, un de l&rsquo;Alice i un del Bob.

&#x1f4a1; Els exemples pràctics del post estan fets en testnet. Per tant, si es vol executar les comandes del Bob i l&rsquo;Alice amb els mateixos valors o buscar les transaccions a un explorador s&rsquo;ha de fer des de les versions de testnet corresponents.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://pesvi.xyz/catal%C3%A0/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Com fer una transacció amb UTXOs de wallets diferents amb Sparrow",
      "item": "https://pesvi.xyz/catal%C3%A0/posts/psbt_sparrow/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Com fer una transacció amb UTXOs de wallets diferents amb Sparrow",
  "name": "Com fer una transacció amb UTXOs de wallets diferents amb Sparrow",
  "description": "Suposem que en Bob i la Alice comparteixen pis i volen comprar un televisor que val 2 bitcoins pagant la meitat cada un. Per fer-ho en Bob podria enviar 1 bitcoin a la Alice perquè ella fes el pagament del televisor, però com que les comissions de xarxa són bastant elevades, decideixen crear una transacció conjunta on hi hagi dos inputs, un de l\u0026rsquo;Alice i un del Bob.\n\u0026#x1f4a1; Els exemples pràctics del post estan fets en testnet. Per tant, si es vol executar les comandes del Bob i l\u0026rsquo;Alice amb els mateixos valors o buscar les transaccions a un explorador s\u0026rsquo;ha de fer des de les versions de testnet corresponents.\n",
  "keywords": [
    "Wallets", "UTXO management", "PSBT", "Sparrow", "Layer 1", "Bitcoin-cli"
  ],
  "articleBody": "Suposem que en Bob i la Alice comparteixen pis i volen comprar un televisor que val 2 bitcoins pagant la meitat cada un. Per fer-ho en Bob podria enviar 1 bitcoin a la Alice perquè ella fes el pagament del televisor, però com que les comissions de xarxa són bastant elevades, decideixen crear una transacció conjunta on hi hagi dos inputs, un de l’Alice i un del Bob.\n💡 Els exemples pràctics del post estan fets en testnet. Per tant, si es vol executar les comandes del Bob i l’Alice amb els mateixos valors o buscar les transaccions a un explorador s’ha de fer des de les versions de testnet corresponents.\nCrear la PSBT El primer que fan és crear una transacció parcialment firmada (PSBT) on especifiquen les UTXO que vol gastar cada un i la sortida que volen crear.\nLes dades per l’entrada de la PSBT són les dues UTXO de 1.000005 bitcoins cada una:\nUTXO de l’Alice: 73c13b277a1b176fd2b20324027fff9244949fc5dc913aa98c68bddf246260e5:0\nUTXO del Bob: 7797817c9b879c3333e1c7d5eedc70e6aa0ba1a2c6d098c94ce5e2671f4c9d5e:1\nLes dades per la sortida són l’adreça de destí i la quantitat de bitcoins que hi volen enviar:\nAdreça destí: tb1qjdntspzahv748vasmnfl62etfz9y9hjgmvg6gw\nQuantitat de bitcoins: 2 btc\nCom que utilitzen Sparrow com a wallet i aquesta no permet la creació de PSBTs d’aquest tipus han d’utilitzar una altra eina. Per fer-ho fan servir el seu propi node de Bitcoin i la seva interfície de comandes (bitcoin-cli).\nPer crear la PSBT fan servir bitcoin-cli i la comanda \"createpsbt\".\nAquesta pren dos arguments obligatoris, els inputs i els outputs. Per l’input s’ha d’especificar l’id de la transacció i el número de l’output. Per l’output s’ha d’especificar l’adreça de destí i la quantitat de bitcoins que es vol enviar.\nbitcoin-cli createpsbt '[{\"txid\": \"txId\", \"vout\": nOut}]' '[{\"adreça de destí\": \"núm btc\"}]' ⚠️ ALERTA!\nLa diferència entre el valor de les entrades i el valor de la sortida es paga en forma de comissió. Si es vol retornar els diners restants, s’ha d’afegir una sortida amb una adreça de canvi i donar-li un valor!\nLa comanda que executen l’Alice i en Bob és la següent:\nbitcoin-cli createpsbt '[{\"txid\": \"73c13b277a1b176fd2b20324027fff9244949fc5dc913aa98c68bddf246260e5\", \"vout\": 0}, {\"txid\": \"7797817c9b879c3333e1c7d5eedc70e6aa0ba1a2c6d098c94ce5e2671f4c9d5e\", \"vout\": 1}]' '[{\"tb1qjdntspzahv748vasmnfl62etfz9y9hjgmvg6gw\": 2}]' Output:\ncHNidP8BAHsCAAAAAuVgYiTfvWiMqTqR3MWflESS/38CJAOy0m8XG3onO8FzAAAAAAD9////Xp1MH2fi5UzJmNDGoqELquZw3O7Vx+EzM5yHm3yBl3cBAAAAAP3///8BAMLrCwAAAAAWABSTZrgEXbs9U7Ow3NP9KytIikLeSAAAAAAAAAAA L’output que obtenen és la transacció en raw i codificada en base64. Aquesta transacció encara no està llesta per ser firmada, necessita que se li actualitzi la informació dels inputs i els outputs segwit. Per tal d’acabar de muntar correctament la transacció en Bob i l’Alice utilitzen la comanda \"utxoupdatepsbt\". Aquesta comanda pren com a únic argument una transacció en raw codificada en base64, exactament com la que ens genera la comanda “createpsbt”.\nbitcoin-cli utxoupdatepsbt \"transacció en raw i base64\" La comanda que executen l’Alice i en Bob queda de la següent manera:\nbitcoin-cli utxoupdatepsbt \"cHNidP8BAHsCAAAAAuVgYiTfvWiMqTqR3MWflESS/38CJAOy0m8XG3onO8FzAAAAAAD9////Xp1MH2fi5UzJmNDGoqELquZw3O7Vx+EzM5yHm3yBl3cBAAAAAP3///8BAMLrCwAAAAAWABSTZrgEXbs9U7Ow3NP9KytIikLeSAAAAAAAAAAA\" Output:\ncHNidP8BAHsCAAAAAuVgYiTfvWiMqTqR3MWflESS/38CJAOy0m8XG3onO8FzAAAAAAD9////Xp1MH2fi5UzJmNDGoqELquZw3O7Vx+EzM5yHm3yBl3cBAAAAAP3///8BAMLrCwAAAAAWABSTZrgEXbs9U7Ow3NP9KytIikLeSAAAAAAAAQEf9OL1BQAAAAAWABSwcT0MvrjbtH8Tu7UWrYU7nU5ocwABAR/04vUFAAAAABYAFKnH89dqqyObFvPlDONKPDSRm78cAAA= L’output és la mateixa transacció en raw i codificada en base64 però aquest cop ja llesta per ser firmada. Es pot comprovar l’estat de la PSBT amb la comanda \"analyzepsbt\". Aquesta comanda analitza la PSBT i dona informació sobre l’estat d’aquesta. Pren com a argument una PSBT en raw i base64:\nbitcoin-cli analyzepsbt \"transacció en raw i base64\" En Bob i l’Alice comproven l’estat de la seva PSBT amb la següent comanda:\nbitcoin-cli analyzepsbt \"cHNidP8BAHsCAAAAAuVgYiTfvWiMqTqR3MWflESS/38CJAOy0m8XG3onO8FzAAAAAAD9////Xp1MH2fi5UzJmNDGoqELquZw3O7Vx+EzM5yHm3yBl3cBAAAAAP3///8BAMLrCwAAAAAWABSTZrgEXbs9U7Ow3NP9KytIikLeSAAAAAAAAQEf9OL1BQAAAAAWABSwcT0MvrjbtH8Tu7UWrYU7nU5ocwABAR/04vUFAAAAABYAFKnH89dqqyObFvPlDONKPDSRm78cAAA=\" Output:\n{ \"inputs\": [ { \"has_utxo\": true, \"is_final\": false, \"next\": \"updater\", \"missing\": { \"pubkeys\": [ \"b0713d0cbeb8dbb47f13bbb516ad853b9d4e6873\" ] } }, { \"has_utxo\": true, \"is_final\": false, \"next\": \"updater\", \"missing\": { \"pubkeys\": [ \"a9c7f3d76aab239b16f3e50ce34a3c34919bbf1c\" ] } } ], \"fee\": 0.00001000, \"next\": \"updater\" } En el JSON que ens proporciona la sortida podem veure com falten les dues firmes, tant la de l’Alice com la del Bob.\n💡 Idea!\nLa comanda anterior també ens permet veure quants bitcoins paga la transacció en forma de comissions, és bona idea revisar que no estem pagant més del compte!\nFirmar la PSBT La primera a firmar la transacció serà l’Alice. Per fer-ho obre la seva wallet a Sparrow i carrega la transacció obtinguda de la comanda “utxoupdatepsbt” en forma de text:\nAmb la transacció carregada es pot veure com el propi Sparrow detecta que la primera entrada pertany a l’Alice: Per tal de firmar-la l’Alice prem “Finalize Transaction for Signing” i a continuació “Sign”. Un cop firmada l’Alice es guarda la transacció prement l’opció de “Save Transaction”. Això li genera un fitxer “.psbt”.\nCom que té curiositat per saber si s’ha fet correctament torna a executar la comanda “analyzepsbt”. Aquesta pren com a argument una transacció en raw i codificada en base64. Per tal de mostrar la transacció del fitxer “.psbt” en el format necessari l’Alice utilitza la comanda:\ncat alice.psbt | base64 -w 0 Output:\ncHNidP8BAHsCAAAAAuVgYiTfvWiMqTqR3MWflESS/38CJAOy0m8XG3onO8FzAAAAAAD9////Xp1MH2fi5UzJmNDGoqELquZw3O7Vx+EzM5yHm3yBl3cBAAAAAP3///8BAMLrCwAAAAAWABSTZrgEXbs9U7Ow3NP9KytIikLeSAAAAAAAAQEf9OL1BQAAAAAWABSwcT0MvrjbtH8Tu7UWrYU7nU5ocyICAqMy+J7K6eLwFZ82KfZ8NEOYP/fT2XJBP7fZKzgTHebMRzBEAiAfOG5ztzUxczR0VOE/RyEHFzE+7WzxURU2M3uaMneq2wIgdNMkWI40nt+IB+LFq8vJ+/s3JqDCk/0IB51Bj/vdtFcBAAEBH/Ti9QUAAAAAFgAUqcfz12qrI5sW8+UM40o8NJGbvxwAAA== Ja pot executar la comanda “analyzepsbt” amb la transacció codificada correctament:\nbitcoin-cli analyzepsbt \"cHNidP8BAHsCAAAAAuVgYiTfvWiMqTqR3MWflESS/38CJAOy0m8XG3onO8FzAAAAAAD9////Xp1MH2fi5UzJmNDGoqELquZw3O7Vx+EzM5yHm3yBl3cBAAAAAP3///8BAMLrCwAAAAAWABSTZrgEXbs9U7Ow3NP9KytIikLeSAAAAAAAAQEf9OL1BQAAAAAWABSwcT0MvrjbtH8Tu7UWrYU7nU5ocyICAqMy+J7K6eLwFZ82KfZ8NEOYP/fT2XJBP7fZKzgTHebMRzBEAiAfOG5ztzUxczR0VOE/RyEHFzE+7WzxURU2M3uaMneq2wIgdNMkWI40nt+IB+LFq8vJ+/s3JqDCk/0IB51Bj/vdtFcBAAEBH/Ti9QUAAAAAFgAUqcfz12qrI5sW8+UM40o8NJGbvxwAAA==\" Output:\n{ \"inputs\": [ { \"has_utxo\": true, \"is_final\": false, \"next\": \"finalizer\" }, { \"has_utxo\": true, \"is_final\": false, \"next\": \"updater\", \"missing\": { \"pubkeys\": [ \"a9c7f3d76aab239b16f3e50ce34a3c34919bbf1c\" ] } } ], \"fee\": 0.00001000, \"next\": \"updater\" } Ara l’Alice té la certesa que ha firmat, ja que la sortida de la comanda mostra que només falta la firma d’en Bob.\nEn Bob realitza els mateixos passos que ha fet l’Alice per firmar la transacció.\n⚠️ Alerta!\nEn Bob repeteix els passos amb la transacció obtinguda en la comanda “utxoupdatepsbt” no amb la transacció firmada de l’Alice!\nEn acabat executa la comanda “analyzepsbt” també per assegurar-se que ha firmat correctament:\nbitcoin-cli analyzepsbt \"cHNidP8BAHsCAAAAAuVgYiTfvWiMqTqR3MWflESS/38CJAOy0m8XG3onO8FzAAAAAAD9////Xp1MH2fi5UzJmNDGoqELquZw3O7Vx+EzM5yHm3yBl3cBAAAAAP3///8BAMLrCwAAAAAWABSTZrgEXbs9U7Ow3NP9KytIikLeSAAAAAAAAQEf9OL1BQAAAAAWABSwcT0MvrjbtH8Tu7UWrYU7nU5ocwABAR/04vUFAAAAABYAFKnH89dqqyObFvPlDONKPDSRm78cIgIDDHkSKRVSKLVTwBM8zclLbfzoU0ax431MOeTO7jhNgQJHMEQCIHu7QJ227MnOCoWIgkfKkFpiBlUEfm/Tzs66+wSti5LnAiB767C0BufcXueZR/muH+DeFVSGTE+Hbjt8sgvlyUDGZAEAAA==\" Output:\n{ \"inputs\": [ { \"has_utxo\": true, \"is_final\": false, \"next\": \"updater\", \"missing\": { \"pubkeys\": [ \"b0713d0cbeb8dbb47f13bbb516ad853b9d4e6873\" ] } }, { \"has_utxo\": true, \"is_final\": false, \"next\": \"finalizer\" } ], \"fee\": 0.00001000, \"next\": \"updater\" } En Bob pot veure que la seva firma s’ha afegit correctament i li marca com a pendent la firma de l’Alice.\nFusionar les PSBT i retransmetre la transacció final Arribats a aquest punt en Bob i l’Alice tenen cada un la PSBT firmada per separat. Només els falta fusionar-les per tal de tenir la transacció final i poder-la retransmetre a la xarxa.\nPer fusionar-les utilitzen la comanda \"combinepsbt\". Aquesta pren per arguments les PSBT en una llista de la següent manera:\nbitcoin-cli combinepsbt '[\"psbt_alice\", \"psbt_bob\"]' La comanda que executen és la següent:\nbitcoin-cli combinepsbt '[\"cHNidP8BAHsCAAAAAuVgYiTfvWiMqTqR3MWflESS/38CJAOy0m8XG3onO8FzAAAAAAD9////Xp1MH2fi5UzJmNDGoqELquZw3O7Vx+EzM5yHm3yBl3cBAAAAAP3///8BAMLrCwAAAAAWABSTZrgEXbs9U7Ow3NP9KytIikLeSAAAAAAAAQEf9OL1BQAAAAAWABSwcT0MvrjbtH8Tu7UWrYU7nU5ocyICAqMy+J7K6eLwFZ82KfZ8NEOYP/fT2XJBP7fZKzgTHebMRzBEAiAfOG5ztzUxczR0VOE/RyEHFzE+7WzxURU2M3uaMneq2wIgdNMkWI40nt+IB+LFq8vJ+/s3JqDCk/0IB51Bj/vdtFcBAAEBH/Ti9QUAAAAAFgAUqcfz12qrI5sW8+UM40o8NJGbvxwAAA==\", \"cHNidP8BAHsCAAAAAuVgYiTfvWiMqTqR3MWflESS/38CJAOy0m8XG3onO8FzAAAAAAD9////Xp1MH2fi5UzJmNDGoqELquZw3O7Vx+EzM5yHm3yBl3cBAAAAAP3///8BAMLrCwAAAAAWABSTZrgEXbs9U7Ow3NP9KytIikLeSAAAAAAAAQEf9OL1BQAAAAAWABSwcT0MvrjbtH8Tu7UWrYU7nU5ocwABAR/04vUFAAAAABYAFKnH89dqqyObFvPlDONKPDSRm78cIgIDDHkSKRVSKLVTwBM8zclLbfzoU0ax431MOeTO7jhNgQJHMEQCIHu7QJ227MnOCoWIgkfKkFpiBlUEfm/Tzs66+wSti5LnAiB767C0BufcXueZR/muH+DeFVSGTE+Hbjt8sgvlyUDGZAEAAA==\"]' Output:\ncHNidP8BAHsCAAAAAuVgYiTfvWiMqTqR3MWflESS/38CJAOy0m8XG3onO8FzAAAAAAD9////Xp1MH2fi5UzJmNDGoqELquZw3O7Vx+EzM5yHm3yBl3cBAAAAAP3///8BAMLrCwAAAAAWABSTZrgEXbs9U7Ow3NP9KytIikLeSAAAAAAAAQEf9OL1BQAAAAAWABSwcT0MvrjbtH8Tu7UWrYU7nU5ocyICAqMy+J7K6eLwFZ82KfZ8NEOYP/fT2XJBP7fZKzgTHebMRzBEAiAfOG5ztzUxczR0VOE/RyEHFzE+7WzxURU2M3uaMneq2wIgdNMkWI40nt+IB+LFq8vJ+/s3JqDCk/0IB51Bj/vdtFcBAAEBH/Ti9QUAAAAAFgAUqcfz12qrI5sW8+UM40o8NJGbvxwiAgMMeRIpFVIotVPAEzzNyUtt/OhTRrHjfUw55M7uOE2BAkcwRAIge7tAnbbsyc4KhYiCR8qQWmIGVQR+b9POzrr7BK2LkucCIHvrsLQG59xe55lH+a4f4N4VVIZMT4duO3yyC+XJQMZkAQAA La sortida de la comanda és la PSBT agregada dels dos. Poden fer una última comprovació amb la comanda “analyzepsbt”:\nbitcoin-cli analyzepsbt \"cHNidP8BAHsCAAAAAuVgYiTfvWiMqTqR3MWflESS/38CJAOy0m8XG3onO8FzAAAAAAD9////Xp1MH2fi5UzJmNDGoqELquZw3O7Vx+EzM5yHm3yBl3cBAAAAAP3///8BAMLrCwAAAAAWABSTZrgEXbs9U7Ow3NP9KytIikLeSAAAAAAAAQEf9OL1BQAAAAAWABSwcT0MvrjbtH8Tu7UWrYU7nU5ocyICAqMy+J7K6eLwFZ82KfZ8NEOYP/fT2XJBP7fZKzgTHebMRzBEAiAfOG5ztzUxczR0VOE/RyEHFzE+7WzxURU2M3uaMneq2wIgdNMkWI40nt+IB+LFq8vJ+/s3JqDCk/0IB51Bj/vdtFcBAAEBH/Ti9QUAAAAAFgAUqcfz12qrI5sW8+UM40o8NJGbvxwiAgMMeRIpFVIotVPAEzzNyUtt/OhTRrHjfUw55M7uOE2BAkcwRAIge7tAnbbsyc4KhYiCR8qQWmIGVQR+b9POzrr7BK2LkucCIHvrsLQG59xe55lH+a4f4N4VVIZMT4duO3yyC+XJQMZkAQAA\" { \"inputs\": [ { \"has_utxo\": true, \"is_final\": false, \"next\": \"finalizer\" }, { \"has_utxo\": true, \"is_final\": false, \"next\": \"finalizer\" } ], \"estimated_vsize\": 177, \"estimated_feerate\": 0.00005649, \"fee\": 0.00001000, \"next\": \"finalizer\" } Comproven així que no falta cap de les dues firmes. A partir d’aquest punt qualsevol dels dos pot retransmetre la transacció carregant-la a l’Sparrow des de text, com s’ha fet en els passos anteriors, i prenent l’opció de “Broadcast Transaction” Podem comprovar a qualsevol explorador de blocs que la transacció s’ha enviat correctament i paga els 2 bitcoins pel televisor:\nid de la transacció: c659c7cb31733f153f04c1fbffeec91b99a96f2e289f47852374d0101e303e50 La transacció ha sigut enviada correctament i en Bob i l’Alice han pogut pagar el televisor amb una transacció conjunta!! ",
  "wordCount" : "1150",
  "inLanguage": "català",
  "datePublished": "2024-04-07T00:00:00Z",
  "dateModified": "2024-04-07T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Pol Espinasa"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://pesvi.xyz/catal%C3%A0/posts/psbt_sparrow/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Descobreix Bitcoin i la Lightning Network",
    "logo": {
      "@type": "ImageObject",
      "url": "https://pesvi.xyz/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://pesvi.xyz/catal%C3%A0/" accesskey="h" title="Descobreix Bitcoin i la Lightning Network (Alt + H)">Descobreix Bitcoin i la Lightning Network</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="https://pesvi.xyz/" title="English"
                            aria-label="English">English</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://pesvi.xyz/catal%C3%A0/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://pesvi.xyz/catal%C3%A0/pullrequests/" title="PRs">
                    <span>PRs</span>
                </a>
            </li>
            <li>
                <a href="https://pesvi.xyz/catal%C3%A0/publications/" title="Publications">
                    <span>Publications</span>
                </a>
            </li>
            <li>
                <a href="https://pesvi.xyz/catal%C3%A0/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://pesvi.xyz/catal%C3%A0/resources/" title="Resources">
                    <span>Resources</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Com fer una transacció amb UTXOs de wallets diferents amb Sparrow
    </h1>
    <div class="post-meta"><span title='2024-04-07 00:00:00 +0000 UTC'>April 7, 2024</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Pol Espinasa&nbsp;|&nbsp;Translations:
<ul class="i18n_list">
    <li>
        <a href="https://pesvi.xyz/posts/psbt_sparrow/">English</a>
    </li>
</ul>

</div>
  </header> 
  <div class="post-content"><p>Suposem que en Bob i la Alice comparteixen pis i volen comprar un televisor que val 2 bitcoins pagant la meitat cada un.
Per fer-ho en Bob podria enviar 1 bitcoin a la Alice perquè ella fes el pagament del televisor, però com que les comissions de xarxa són bastant elevades, decideixen crear una transacció conjunta on hi hagi dos inputs, un de l&rsquo;Alice i un del Bob.</p>
<blockquote>
<p>&#x1f4a1; <em>Els exemples pràctics del post estan fets en testnet. Per tant, si es vol executar les comandes del Bob i l&rsquo;Alice amb els mateixos valors o buscar les transaccions a un explorador s&rsquo;ha de fer des de les versions de testnet corresponents.</em></p>
</blockquote>
<h3 id="crear-la-psbt">Crear la PSBT<a hidden class="anchor" aria-hidden="true" href="#crear-la-psbt">#</a></h3>
<p>El primer que fan és crear una transacció parcialment firmada (PSBT) on especifiquen les UTXO que vol gastar cada un i la sortida que volen crear.</p>
<p>Les dades per l&rsquo;entrada de la PSBT són les dues UTXO de 1.000005 bitcoins cada una:</p>
<p>UTXO de l&rsquo;Alice: <code>73c13b277a1b176fd2b20324027fff9244949fc5dc913aa98c68bddf246260e5:0</code><br>
UTXO del Bob: <code>7797817c9b879c3333e1c7d5eedc70e6aa0ba1a2c6d098c94ce5e2671f4c9d5e:1</code></p>
<p>Les dades per la sortida són l&rsquo;adreça de destí i la quantitat de bitcoins que hi volen enviar:</p>
<p>Adreça destí: <code>tb1qjdntspzahv748vasmnfl62etfz9y9hjgmvg6gw</code><br>
Quantitat de bitcoins: <code>2 btc</code></p>
<p>Com que utilitzen <a href="https://sparrowwallet.com/">Sparrow</a> com a wallet i aquesta no permet la creació de PSBTs d&rsquo;aquest tipus han d&rsquo;utilitzar una altra eina. Per fer-ho fan servir el seu propi node de Bitcoin i la seva interfície de comandes (<a href="https://developer.bitcoin.org/reference/rpc/index.html">bitcoin-cli</a>).</p>
<p>Per crear la PSBT fan servir bitcoin-cli i la comanda <a href="https://developer.bitcoin.org/reference/rpc/createpsbt.html">&quot;<em>createpsbt</em>&quot;</a>.<br>
Aquesta pren dos arguments obligatoris, els inputs i els outputs. Per l&rsquo;input s&rsquo;ha d&rsquo;especificar l&rsquo;id de la transacció i el número de l&rsquo;output. Per l&rsquo;output s&rsquo;ha d&rsquo;especificar l&rsquo;adreça de destí i la quantitat de bitcoins que es vol enviar.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bitcoin-cli createpsbt <span style="color:#e6db74">&#39;[{&#34;txid&#34;: &#34;txId&#34;, &#34;vout&#34;: nOut}]&#39;</span> <span style="color:#e6db74">&#39;[{&#34;adreça de destí&#34;: &#34;núm btc&#34;}]&#39;</span>
</span></span></code></pre></div><blockquote>
<p>&#x26a0;&#xfe0f; <strong>ALERTA!</strong><br>
<em>La diferència entre el valor de les entrades i el valor de la sortida es paga en forma de comissió. Si es vol retornar els diners restants, s&rsquo;ha d&rsquo;afegir una sortida amb una adreça de canvi i donar-li un valor!</em></p>
</blockquote>
<p>La comanda que executen l&rsquo;Alice i en Bob és la següent:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bitcoin-cli createpsbt <span style="color:#e6db74">&#39;[{&#34;txid&#34;: &#34;73c13b277a1b176fd2b20324027fff9244949fc5dc913aa98c68bddf246260e5&#34;, &#34;vout&#34;: 0}, {&#34;txid&#34;: &#34;7797817c9b879c3333e1c7d5eedc70e6aa0ba1a2c6d098c94ce5e2671f4c9d5e&#34;, &#34;vout&#34;: 1}]&#39;</span> <span style="color:#e6db74">&#39;[{&#34;tb1qjdntspzahv748vasmnfl62etfz9y9hjgmvg6gw&#34;: 2}]&#39;</span>
</span></span></code></pre></div><p>Output:</p>
<pre tabindex="0"><code>cHNidP8BAHsCAAAAAuVgYiTfvWiMqTqR3MWflESS/38CJAOy0m8XG3onO8FzAAAAAAD9////Xp1MH2fi5UzJmNDGoqELquZw3O7Vx+EzM5yHm3yBl3cBAAAAAP3///8BAMLrCwAAAAAWABSTZrgEXbs9U7Ow3NP9KytIikLeSAAAAAAAAAAA
</code></pre><p>L&rsquo;output que obtenen és la transacció en raw i codificada en base64. Aquesta transacció encara no està llesta per ser firmada, necessita que se li actualitzi la informació dels inputs i els outputs segwit. Per tal d&rsquo;acabar de muntar correctament la transacció en Bob i l&rsquo;Alice utilitzen la comanda <a href="https://developer.bitcoin.org/reference/rpc/utxoupdatepsbt.html">&quot;<em>utxoupdatepsbt</em>&quot;</a>.
Aquesta comanda pren com a únic argument una transacció en raw codificada en base64, exactament com la que ens genera la comanda &ldquo;<em>createpsbt</em>&rdquo;.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bitcoin-cli utxoupdatepsbt <span style="color:#e6db74">&#34;transacció en raw i base64&#34;</span>
</span></span></code></pre></div><p>La comanda que executen l&rsquo;Alice i en Bob queda de la següent manera:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bitcoin-cli utxoupdatepsbt <span style="color:#e6db74">&#34;cHNidP8BAHsCAAAAAuVgYiTfvWiMqTqR3MWflESS/38CJAOy0m8XG3onO8FzAAAAAAD9////Xp1MH2fi5UzJmNDGoqELquZw3O7Vx+EzM5yHm3yBl3cBAAAAAP3///8BAMLrCwAAAAAWABSTZrgEXbs9U7Ow3NP9KytIikLeSAAAAAAAAAAA&#34;</span>
</span></span></code></pre></div><p>Output:</p>
<pre tabindex="0"><code>cHNidP8BAHsCAAAAAuVgYiTfvWiMqTqR3MWflESS/38CJAOy0m8XG3onO8FzAAAAAAD9////Xp1MH2fi5UzJmNDGoqELquZw3O7Vx+EzM5yHm3yBl3cBAAAAAP3///8BAMLrCwAAAAAWABSTZrgEXbs9U7Ow3NP9KytIikLeSAAAAAAAAQEf9OL1BQAAAAAWABSwcT0MvrjbtH8Tu7UWrYU7nU5ocwABAR/04vUFAAAAABYAFKnH89dqqyObFvPlDONKPDSRm78cAAA=
</code></pre><p>L&rsquo;output és la mateixa transacció en raw i codificada en base64 però aquest cop ja llesta per ser firmada.
Es pot comprovar l&rsquo;estat de la PSBT amb la comanda <a href="https://developer.bitcoin.org/reference/rpc/analyzepsbt.html">&quot;<em>analyzepsbt</em>&quot;</a>. Aquesta comanda analitza la PSBT i dona informació sobre l&rsquo;estat d&rsquo;aquesta.
Pren com a argument una PSBT en raw i base64:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bitcoin-cli analyzepsbt <span style="color:#e6db74">&#34;transacció en raw i base64&#34;</span>
</span></span></code></pre></div><p>En Bob i l&rsquo;Alice comproven l&rsquo;estat de la seva PSBT amb la següent comanda:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bitcoin-cli analyzepsbt <span style="color:#e6db74">&#34;cHNidP8BAHsCAAAAAuVgYiTfvWiMqTqR3MWflESS/38CJAOy0m8XG3onO8FzAAAAAAD9////Xp1MH2fi5UzJmNDGoqELquZw3O7Vx+EzM5yHm3yBl3cBAAAAAP3///8BAMLrCwAAAAAWABSTZrgEXbs9U7Ow3NP9KytIikLeSAAAAAAAAQEf9OL1BQAAAAAWABSwcT0MvrjbtH8Tu7UWrYU7nU5ocwABAR/04vUFAAAAABYAFKnH89dqqyObFvPlDONKPDSRm78cAAA=&#34;</span>
</span></span></code></pre></div><p>Output:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;inputs&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;has_utxo&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;is_final&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;next&#34;</span>: <span style="color:#e6db74">&#34;updater&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;missing&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;pubkeys&#34;</span>: [
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#34;b0713d0cbeb8dbb47f13bbb516ad853b9d4e6873&#34;</span>
</span></span><span style="display:flex;"><span>        ]
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;has_utxo&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;is_final&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;next&#34;</span>: <span style="color:#e6db74">&#34;updater&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;missing&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;pubkeys&#34;</span>: [
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#34;a9c7f3d76aab239b16f3e50ce34a3c34919bbf1c&#34;</span>
</span></span><span style="display:flex;"><span>        ]
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;fee&#34;</span>: <span style="color:#ae81ff">0.00001000</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;next&#34;</span>: <span style="color:#e6db74">&#34;updater&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>En el JSON que ens proporciona la sortida podem veure com falten les dues firmes, tant la de l&rsquo;Alice com la del Bob.</p>
<blockquote>
<p>&#x1f4a1; <strong>Idea!</strong><br>
<em>La comanda anterior també ens permet veure quants bitcoins paga la transacció en forma de comissions, és bona idea revisar que no estem pagant més del compte!</em></p>
</blockquote>
<h3 id="firmar-la-psbt">Firmar la PSBT<a hidden class="anchor" aria-hidden="true" href="#firmar-la-psbt">#</a></h3>
<p>La primera a firmar la transacció serà l&rsquo;Alice. Per fer-ho obre la seva wallet a Sparrow i carrega la transacció obtinguda de la comanda &ldquo;<em>utxoupdatepsbt</em>&rdquo; en forma de text:</p>
<p><img loading="lazy" src="/psbt_multi_utxo_sparrow/openTx.png#center">
<img loading="lazy" src="/psbt_multi_utxo_sparrow/open_from_text.png#center"></p>
<p>Amb la transacció carregada es pot veure com el propi Sparrow detecta que la primera entrada pertany a l&rsquo;Alice:
<img loading="lazy" src="/psbt_multi_utxo_sparrow/tx_pre_sign_alice.png#center"></p>
<p>Per tal de firmar-la l&rsquo;Alice prem &ldquo;<em>Finalize Transaction for Signing</em>&rdquo; i a continuació &ldquo;<em>Sign</em>&rdquo;.
Un cop firmada l&rsquo;Alice es guarda la transacció prement l&rsquo;opció de &ldquo;Save Transaction&rdquo;. Això li genera un fitxer &ldquo;<em>.psbt</em>&rdquo;.</p>
<p>Com que té curiositat per saber si s&rsquo;ha fet correctament torna a executar la comanda &ldquo;<em>analyzepsbt</em>&rdquo;. Aquesta pren com a argument una transacció en raw i codificada en base64. Per tal de mostrar la transacció del fitxer &ldquo;<em>.psbt</em>&rdquo; en el format necessari l&rsquo;Alice utilitza la comanda:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat alice.psbt | base64 -w <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><p>Output:</p>
<pre tabindex="0"><code>cHNidP8BAHsCAAAAAuVgYiTfvWiMqTqR3MWflESS/38CJAOy0m8XG3onO8FzAAAAAAD9////Xp1MH2fi5UzJmNDGoqELquZw3O7Vx+EzM5yHm3yBl3cBAAAAAP3///8BAMLrCwAAAAAWABSTZrgEXbs9U7Ow3NP9KytIikLeSAAAAAAAAQEf9OL1BQAAAAAWABSwcT0MvrjbtH8Tu7UWrYU7nU5ocyICAqMy+J7K6eLwFZ82KfZ8NEOYP/fT2XJBP7fZKzgTHebMRzBEAiAfOG5ztzUxczR0VOE/RyEHFzE+7WzxURU2M3uaMneq2wIgdNMkWI40nt+IB+LFq8vJ+/s3JqDCk/0IB51Bj/vdtFcBAAEBH/Ti9QUAAAAAFgAUqcfz12qrI5sW8+UM40o8NJGbvxwAAA==
</code></pre><p>Ja pot executar la comanda &ldquo;<em>analyzepsbt</em>&rdquo; amb la transacció codificada correctament:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bitcoin-cli analyzepsbt <span style="color:#e6db74">&#34;cHNidP8BAHsCAAAAAuVgYiTfvWiMqTqR3MWflESS/38CJAOy0m8XG3onO8FzAAAAAAD9////Xp1MH2fi5UzJmNDGoqELquZw3O7Vx+EzM5yHm3yBl3cBAAAAAP3///8BAMLrCwAAAAAWABSTZrgEXbs9U7Ow3NP9KytIikLeSAAAAAAAAQEf9OL1BQAAAAAWABSwcT0MvrjbtH8Tu7UWrYU7nU5ocyICAqMy+J7K6eLwFZ82KfZ8NEOYP/fT2XJBP7fZKzgTHebMRzBEAiAfOG5ztzUxczR0VOE/RyEHFzE+7WzxURU2M3uaMneq2wIgdNMkWI40nt+IB+LFq8vJ+/s3JqDCk/0IB51Bj/vdtFcBAAEBH/Ti9QUAAAAAFgAUqcfz12qrI5sW8+UM40o8NJGbvxwAAA==&#34;</span>
</span></span></code></pre></div><p>Output:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;inputs&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;has_utxo&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;is_final&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;next&#34;</span>: <span style="color:#e6db74">&#34;finalizer&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;has_utxo&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;is_final&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;next&#34;</span>: <span style="color:#e6db74">&#34;updater&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;missing&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;pubkeys&#34;</span>: [
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#34;a9c7f3d76aab239b16f3e50ce34a3c34919bbf1c&#34;</span>
</span></span><span style="display:flex;"><span>        ]
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;fee&#34;</span>: <span style="color:#ae81ff">0.00001000</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;next&#34;</span>: <span style="color:#e6db74">&#34;updater&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Ara l&rsquo;Alice té la certesa que ha firmat, ja que la sortida de la comanda mostra que només falta la firma d&rsquo;en Bob.</p>
<p>En Bob realitza els mateixos passos que ha fet l&rsquo;Alice per firmar la transacció.</p>
<blockquote>
<p>&#x26a0;&#xfe0f; <strong>Alerta!</strong><br>
<em>En Bob repeteix els passos amb la transacció obtinguda en la comanda &ldquo;utxoupdatepsbt&rdquo; no amb la transacció firmada de l&rsquo;Alice!</em></p>
</blockquote>
<p>En acabat executa la comanda &ldquo;<em>analyzepsbt</em>&rdquo; també per assegurar-se que ha firmat correctament:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bitcoin-cli analyzepsbt <span style="color:#e6db74">&#34;cHNidP8BAHsCAAAAAuVgYiTfvWiMqTqR3MWflESS/38CJAOy0m8XG3onO8FzAAAAAAD9////Xp1MH2fi5UzJmNDGoqELquZw3O7Vx+EzM5yHm3yBl3cBAAAAAP3///8BAMLrCwAAAAAWABSTZrgEXbs9U7Ow3NP9KytIikLeSAAAAAAAAQEf9OL1BQAAAAAWABSwcT0MvrjbtH8Tu7UWrYU7nU5ocwABAR/04vUFAAAAABYAFKnH89dqqyObFvPlDONKPDSRm78cIgIDDHkSKRVSKLVTwBM8zclLbfzoU0ax431MOeTO7jhNgQJHMEQCIHu7QJ227MnOCoWIgkfKkFpiBlUEfm/Tzs66+wSti5LnAiB767C0BufcXueZR/muH+DeFVSGTE+Hbjt8sgvlyUDGZAEAAA==&#34;</span>
</span></span></code></pre></div><p>Output:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;inputs&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;has_utxo&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;is_final&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;next&#34;</span>: <span style="color:#e6db74">&#34;updater&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;missing&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;pubkeys&#34;</span>: [
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#34;b0713d0cbeb8dbb47f13bbb516ad853b9d4e6873&#34;</span>
</span></span><span style="display:flex;"><span>        ]
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;has_utxo&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;is_final&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;next&#34;</span>: <span style="color:#e6db74">&#34;finalizer&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;fee&#34;</span>: <span style="color:#ae81ff">0.00001000</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;next&#34;</span>: <span style="color:#e6db74">&#34;updater&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>En Bob pot veure que la seva firma s&rsquo;ha afegit correctament i li marca com a pendent la firma de l&rsquo;Alice.</p>
<h3 id="fusionar-les-psbt-i-retransmetre-la-transacció-final">Fusionar les PSBT i retransmetre la transacció final<a hidden class="anchor" aria-hidden="true" href="#fusionar-les-psbt-i-retransmetre-la-transacció-final">#</a></h3>
<p>Arribats a aquest punt en Bob i l&rsquo;Alice tenen cada un la PSBT firmada per separat. Només els falta fusionar-les per tal de tenir la transacció final i poder-la retransmetre a la xarxa.</p>
<p>Per fusionar-les utilitzen la comanda <a href="https://developer.bitcoin.org/reference/rpc/combinepsbt.html">&quot;<em>combinepsbt</em>&quot;</a>.
Aquesta pren per arguments les PSBT en una llista de la següent manera:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bitcoin-cli combinepsbt <span style="color:#e6db74">&#39;[&#34;psbt_alice&#34;, &#34;psbt_bob&#34;]&#39;</span>
</span></span></code></pre></div><p>La comanda que executen és la següent:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bitcoin-cli combinepsbt <span style="color:#e6db74">&#39;[&#34;cHNidP8BAHsCAAAAAuVgYiTfvWiMqTqR3MWflESS/38CJAOy0m8XG3onO8FzAAAAAAD9////Xp1MH2fi5UzJmNDGoqELquZw3O7Vx+EzM5yHm3yBl3cBAAAAAP3///8BAMLrCwAAAAAWABSTZrgEXbs9U7Ow3NP9KytIikLeSAAAAAAAAQEf9OL1BQAAAAAWABSwcT0MvrjbtH8Tu7UWrYU7nU5ocyICAqMy+J7K6eLwFZ82KfZ8NEOYP/fT2XJBP7fZKzgTHebMRzBEAiAfOG5ztzUxczR0VOE/RyEHFzE+7WzxURU2M3uaMneq2wIgdNMkWI40nt+IB+LFq8vJ+/s3JqDCk/0IB51Bj/vdtFcBAAEBH/Ti9QUAAAAAFgAUqcfz12qrI5sW8+UM40o8NJGbvxwAAA==&#34;, &#34;cHNidP8BAHsCAAAAAuVgYiTfvWiMqTqR3MWflESS/38CJAOy0m8XG3onO8FzAAAAAAD9////Xp1MH2fi5UzJmNDGoqELquZw3O7Vx+EzM5yHm3yBl3cBAAAAAP3///8BAMLrCwAAAAAWABSTZrgEXbs9U7Ow3NP9KytIikLeSAAAAAAAAQEf9OL1BQAAAAAWABSwcT0MvrjbtH8Tu7UWrYU7nU5ocwABAR/04vUFAAAAABYAFKnH89dqqyObFvPlDONKPDSRm78cIgIDDHkSKRVSKLVTwBM8zclLbfzoU0ax431MOeTO7jhNgQJHMEQCIHu7QJ227MnOCoWIgkfKkFpiBlUEfm/Tzs66+wSti5LnAiB767C0BufcXueZR/muH+DeFVSGTE+Hbjt8sgvlyUDGZAEAAA==&#34;]&#39;</span>
</span></span></code></pre></div><p>Output:</p>
<pre tabindex="0"><code>cHNidP8BAHsCAAAAAuVgYiTfvWiMqTqR3MWflESS/38CJAOy0m8XG3onO8FzAAAAAAD9////Xp1MH2fi5UzJmNDGoqELquZw3O7Vx+EzM5yHm3yBl3cBAAAAAP3///8BAMLrCwAAAAAWABSTZrgEXbs9U7Ow3NP9KytIikLeSAAAAAAAAQEf9OL1BQAAAAAWABSwcT0MvrjbtH8Tu7UWrYU7nU5ocyICAqMy+J7K6eLwFZ82KfZ8NEOYP/fT2XJBP7fZKzgTHebMRzBEAiAfOG5ztzUxczR0VOE/RyEHFzE+7WzxURU2M3uaMneq2wIgdNMkWI40nt+IB+LFq8vJ+/s3JqDCk/0IB51Bj/vdtFcBAAEBH/Ti9QUAAAAAFgAUqcfz12qrI5sW8+UM40o8NJGbvxwiAgMMeRIpFVIotVPAEzzNyUtt/OhTRrHjfUw55M7uOE2BAkcwRAIge7tAnbbsyc4KhYiCR8qQWmIGVQR+b9POzrr7BK2LkucCIHvrsLQG59xe55lH+a4f4N4VVIZMT4duO3yyC+XJQMZkAQAA
</code></pre><p>La sortida de la comanda és la PSBT agregada dels dos. Poden fer una última comprovació amb la comanda &ldquo;<em>analyzepsbt</em>&rdquo;:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bitcoin-cli analyzepsbt <span style="color:#e6db74">&#34;cHNidP8BAHsCAAAAAuVgYiTfvWiMqTqR3MWflESS/38CJAOy0m8XG3onO8FzAAAAAAD9////Xp1MH2fi5UzJmNDGoqELquZw3O7Vx+EzM5yHm3yBl3cBAAAAAP3///8BAMLrCwAAAAAWABSTZrgEXbs9U7Ow3NP9KytIikLeSAAAAAAAAQEf9OL1BQAAAAAWABSwcT0MvrjbtH8Tu7UWrYU7nU5ocyICAqMy+J7K6eLwFZ82KfZ8NEOYP/fT2XJBP7fZKzgTHebMRzBEAiAfOG5ztzUxczR0VOE/RyEHFzE+7WzxURU2M3uaMneq2wIgdNMkWI40nt+IB+LFq8vJ+/s3JqDCk/0IB51Bj/vdtFcBAAEBH/Ti9QUAAAAAFgAUqcfz12qrI5sW8+UM40o8NJGbvxwiAgMMeRIpFVIotVPAEzzNyUtt/OhTRrHjfUw55M7uOE2BAkcwRAIge7tAnbbsyc4KhYiCR8qQWmIGVQR+b9POzrr7BK2LkucCIHvrsLQG59xe55lH+a4f4N4VVIZMT4duO3yyC+XJQMZkAQAA&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;inputs&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;has_utxo&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;is_final&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;next&#34;</span>: <span style="color:#e6db74">&#34;finalizer&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;has_utxo&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;is_final&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;next&#34;</span>: <span style="color:#e6db74">&#34;finalizer&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;estimated_vsize&#34;</span>: <span style="color:#ae81ff">177</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;estimated_feerate&#34;</span>: <span style="color:#ae81ff">0.00005649</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;fee&#34;</span>: <span style="color:#ae81ff">0.00001000</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;next&#34;</span>: <span style="color:#e6db74">&#34;finalizer&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Comproven així que no falta cap de les dues firmes.
A partir d&rsquo;aquest punt qualsevol dels dos pot retransmetre la transacció carregant-la a l&rsquo;Sparrow des de text, com s&rsquo;ha fet en els passos anteriors, i prenent l&rsquo;opció de &ldquo;<em>Broadcast Transaction</em>&rdquo;
<img loading="lazy" src="/psbt_multi_utxo_sparrow/broadcast.png#center"></p>
<p>Podem comprovar a qualsevol explorador de blocs que la <a href="https://mempool.space/testnet/tx/c659c7cb31733f153f04c1fbffeec91b99a96f2e289f47852374d0101e303e50">transacció</a> s&rsquo;ha enviat correctament i paga els 2 bitcoins pel televisor:</p>
<p>id de la transacció: <code>c659c7cb31733f153f04c1fbffeec91b99a96f2e289f47852374d0101e303e50</code>
<img loading="lazy" src="/psbt_multi_utxo_sparrow/mempool_space.png#center"></p>
<p>La transacció ha sigut enviada correctament i en Bob i l&rsquo;Alice han pogut pagar el televisor amb una transacció conjunta!!
<img loading="lazy" src="/psbt_multi_utxo_sparrow/tv.jpeg#center"></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://pesvi.xyz/catal%C3%A0/tags/wallets/">Wallets</a></li>
      <li><a href="https://pesvi.xyz/catal%C3%A0/tags/utxo-management/">UTXO Management</a></li>
      <li><a href="https://pesvi.xyz/catal%C3%A0/tags/psbt/">PSBT</a></li>
      <li><a href="https://pesvi.xyz/catal%C3%A0/tags/sparrow/">Sparrow</a></li>
      <li><a href="https://pesvi.xyz/catal%C3%A0/tags/layer-1/">Layer 1</a></li>
      <li><a href="https://pesvi.xyz/catal%C3%A0/tags/bitcoin-cli/">Bitcoin-Cli</a></li>
    </ul>

<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Com fer una transacció amb UTXOs de wallets diferents amb Sparrow on x"
            href="https://x.com/intent/tweet/?text=Com%20fer%20una%20transacci%c3%b3%20amb%20UTXOs%20de%20wallets%20diferents%20amb%20Sparrow&amp;url=https%3a%2f%2fpesvi.xyz%2fcatal%25C3%25A0%2fposts%2fpsbt_sparrow%2f&amp;hashtags=Wallets%2cUTXOmanagement%2cPSBT%2cSparrow%2cLayer1%2cBitcoin-cli">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Com fer una transacció amb UTXOs de wallets diferents amb Sparrow on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fpesvi.xyz%2fcatal%25C3%25A0%2fposts%2fpsbt_sparrow%2f&amp;title=Com%20fer%20una%20transacci%c3%b3%20amb%20UTXOs%20de%20wallets%20diferents%20amb%20Sparrow&amp;summary=Com%20fer%20una%20transacci%c3%b3%20amb%20UTXOs%20de%20wallets%20diferents%20amb%20Sparrow&amp;source=https%3a%2f%2fpesvi.xyz%2fcatal%25C3%25A0%2fposts%2fpsbt_sparrow%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Com fer una transacció amb UTXOs de wallets diferents amb Sparrow on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fpesvi.xyz%2fcatal%25C3%25A0%2fposts%2fpsbt_sparrow%2f&title=Com%20fer%20una%20transacci%c3%b3%20amb%20UTXOs%20de%20wallets%20diferents%20amb%20Sparrow">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Com fer una transacció amb UTXOs de wallets diferents amb Sparrow on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fpesvi.xyz%2fcatal%25C3%25A0%2fposts%2fpsbt_sparrow%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Com fer una transacció amb UTXOs de wallets diferents amb Sparrow on whatsapp"
            href="https://api.whatsapp.com/send?text=Com%20fer%20una%20transacci%c3%b3%20amb%20UTXOs%20de%20wallets%20diferents%20amb%20Sparrow%20-%20https%3a%2f%2fpesvi.xyz%2fcatal%25C3%25A0%2fposts%2fpsbt_sparrow%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Com fer una transacció amb UTXOs de wallets diferents amb Sparrow on telegram"
            href="https://telegram.me/share/url?text=Com%20fer%20una%20transacci%c3%b3%20amb%20UTXOs%20de%20wallets%20diferents%20amb%20Sparrow&amp;url=https%3a%2f%2fpesvi.xyz%2fcatal%25C3%25A0%2fposts%2fpsbt_sparrow%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Com fer una transacció amb UTXOs de wallets diferents amb Sparrow on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Com%20fer%20una%20transacci%c3%b3%20amb%20UTXOs%20de%20wallets%20diferents%20amb%20Sparrow&u=https%3a%2f%2fpesvi.xyz%2fcatal%25C3%25A0%2fposts%2fpsbt_sparrow%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://pesvi.xyz/catal%C3%A0/">Descobreix Bitcoin i la Lightning Network</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
